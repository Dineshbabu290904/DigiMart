<%@page import="com.shopping.project.ConnectionProvider"%>
<%@page import="java.sql.*"%>

<%
String id = request.getParameter("id");
String name = request.getParameter("name");
String category = request.getParameter("category");
String description = request.getParameter("description");
String price = request.getParameter("price");
String unit = request.getParameter("unit");
String available_qty = request.getParameter("available_qty");
String status = request.getParameter("status");

// Check if any of the required parameters are null
if (name == null || category == null || description == null || price == null || unit == null || available_qty == null || status == null) {
    response.sendRedirect("addNewProduct.jsp?msg=invalid");
    return;
}

try{
    Connection con = ConnectionProvider.getCon();
    PreparedStatement P = con.prepareStatement("INSERT INTO Products (name, category, price_per_unit, available_qty, description, unit, status) VALUES (?, ?, ?, ?, ?, ?, ?)");
    P.setString(1, name);
    P.setString(2, category);
    P.setString(3, price);
    P.setString(4, available_qty);
    P.setString(5, description);
    P.setString(6, unit);
    P.setString(7, status);
    P.executeUpdate();
    response.sendRedirect("addNewProduct.jsp?msg=done");
}catch(Exception e){
    out.println(e);
    response.sendRedirect("addNewProduct.jsp?msg=invalid");
}
%>