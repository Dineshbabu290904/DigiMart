<%@ page import="com.digimart.project.ConnectionProvider" %>
<%@ page import="java.sql.*" %>
<%@ include file="adminHeader.jsp" %>
<%@ include file="../footer.jsp" %>

<html>
<head>
    <link rel="stylesheet" href="../css/addNewProduct-style.css">
    <title>Add New Product</title>
</head>
<body>

<%
    int id = 1; // Default product ID
    String msg = request.getParameter("msg"); // Get message parameter from the request
    try {
        Connection con = ConnectionProvider.getCon();
        Statement S = con.createStatement();
        ResultSet R = S.executeQuery("SELECT MAX(product_id) FROM Products");
        if (R.next()) {
            id = R.getInt(1) + 1; // Get the next product ID
        }
    } catch (Exception e) {
        e.printStackTrace();
        System.out.println("Error: " + e.getMessage());
    }
%>

<% if (msg != null) { %>
    <h3 class="alert" style="color: <%=(msg.equals("done") ? "green" : "red")%>;">
        <% if (msg.equals("done")) { %>
            Product Added Successfully!
        <% } else { %>
            Something went wrong! Try Again!
        <% } %>
    </h3>
<% } %>

<h3 style="color: yellow;">Product ID: <% out.println(id); %></h3>
<form action="AddProductServlet" method="post">
    
    <input type="hidden" name="id" value="<%= id %>">

    <div class="left-div">
        <h3>Enter Name</h3>
        <input class="input-style" type="text" name="P_name" placeholder="Enter Name" required maxlength="100">
        <hr>
    </div>

    <div class="right-div">
        <h3>Enter Category</h3>
        <input class="input-style" type="text" name="category" placeholder="Enter Category" required maxlength="100">
        <hr>
    </div>

    <div class="left-div">
        <h3>Enter Description</h3>
        <textarea class="input-style" name="description" placeholder="Enter Product Description" required maxlength="500"></textarea>
        <hr>
    </div>

    <div class="right-div">
        <h3>Enter Price</h3>
        <input class="input-style" type="number" step="0.01" name="price" placeholder="Enter Price per unit" required min="0">
        <hr>
    </div>

    <div class="left-div">
        <h3>Unit</h3>
        <input class="input-style" type="text" name="unit" placeholder="Enter Unit (e.g., kg, lb)" required maxlength="20">
        <hr>
    </div>

    <div class="right-div">
        <h3>Available Quantity</h3>
        <input class="input-style" type="number" name="available_qty" placeholder="Enter Available Quantity" required min="0">
        <hr>
    </div>

    <div class="left-div">
        <h3>Product Image (optional)</h3>
        <input class="input-style" type="file" name="productImage" accept="image/*">
        <hr>
    </div>

    <div class="right-div">
        <h3>Status</h3>
        <select name="status" class="input-style">
            <option value="Available">Available</option>
            <option value="Out of Stock">Out of Stock</option>
        </select>
        <hr>
    </div>
    <hr>
    <button class="button">
    	Save<i class='far fa-arrow-alt-circle-right'></i>
    </button>
</form>

</body>
</html>